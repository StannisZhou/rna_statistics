\documentclass[10pt,letterpaper]{article}

% amsmath and amssymb packages, useful for mathematical formulas and symbols
\usepackage{amsmath,amssymb,bm}

% Use adjustwidth environment to exceed column width (see example table in text)
\usepackage{changepage}

% Use Unicode characters when possible
\usepackage[utf8x]{inputenc}

% textcomp package and marvosym package for additional characters
\usepackage{textcomp,marvosym}

% cite package, to clean up citations in the main text. Do not remove.
\usepackage{cite}

% Use nameref to cite supporting information files (see Supporting Information section for more info)
\usepackage{nameref}
\usepackage[colorlinks = true, urlcolor = blue]{hyperref}

% line numbers
\usepackage[right]{lineno}

% ligatures disabled
\usepackage{microtype}
\DisableLigatures[f]{encoding = *, family = * }

% color can be used to apply background shading to table cells only
\usepackage[table]{xcolor}

% array package and thick rules for tables
\usepackage{array}

% create "+" rule type for thick vertical lines
\newcolumntype{+}{!{\vrule width 2pt}}

% create \thickcline for thick horizontal lines of variable length
\newlength\savedwidth
\newcommand\thickcline[1]{%
  \noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
  \cline{#1}%
  \noalign{\vskip\arrayrulewidth}%
  \noalign{\global\arrayrulewidth\savedwidth}%
}

% \thickhline command for thick horizontal lines that span the table
\newcommand\thickhline{\noalign{\global\savedwidth\arrayrulewidth\global\arrayrulewidth 2pt}%
\hline
\noalign{\global\arrayrulewidth\savedwidth}}


% Remove comment for double spacing
%\usepackage{setspace} 
%\doublespacing

% Text layout
\raggedright
\setlength{\parindent}{0.5cm}
\textwidth 5.25in 
\textheight 8.75in

% Bold the 'Figure #' in the caption and separate it from the title/caption with a period
% Captions will be left justified
\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}
\renewcommand{\figurename}{Fig}

% Use the PLoS provided BiBTeX style
\bibliographystyle{plain}

% Remove brackets from numbering in List of References
\makeatletter
\renewcommand{\@biblabel}[1]{\quad#1.}
\makeatother

% Leave date blank
\date{}

% Header and Footer with logo
\usepackage{lastpage,fancyhdr,graphicx}
\usepackage{epstopdf}

%% Customized Macros
\usepackage{booktabs}
\usepackage{multirow}

%% For inline code
\usepackage{listings,lstautogobble}
\newcommand{\inlinecode}[1]{\lstinline{#1}}
% Custom Python Syntax
\lstset
{
    basicstyle=\small\ttfamily,
    frame=L,
    morekeywords={True, False},
    numbers=left,
    numbersep=10pt,
    showstringspaces=false,
    tabsize=3,
}
  
  %%%%%%%%%%%%%%%%%%%%%%%%%%
  
% Some new commands specific to RNA Stat paper

%\newcommand{\its}{{\it single}}
%\newcommand{\itd}{{\it double}}
%\newcommand{\itt}{{\it transitional}}


\begin{document}

% Please keep the abstract below 300 words
\section*{Results}

\subsection*{Basic Notation and Definitions}

Consider a non-coding RNA molecule with $N$ nucleotides.  Counting from 5$^\prime$ to 3$^\prime$, we denote the primary structure by
\begin{equation}
p = (p_1, p_2, \cdots, p_N)  , \text{where }p_i \in \{ A, G, C, U \}, i = 1, \cdots, N
\end{equation}
and the secondary structure by
\begin{equation}
s = \left\{ (j, k) :\text{nucleotides $j$ and $k$ are paired, $1 \leq j < k \leq N$} \right\}
\end{equation}
and we define the {\em segment} at {\em location} $i$ to be 
\begin{equation}
	P_i = (P_{i, 1}, P_{i, 2},P_{i, 3}, P_{i, 4}) = (p_i, p_{i + 1},p_{i + 2},p_{i + 3})
\end{equation}
There is no particular reason for using segments of length four, and in fact all qualitative conclusions are identical with segment lengths three, four, or five, 
and, for that matter, whether or not we include the G$\cdot$U wobble pairs. 
We chose to include them.

Which segments are viable complementary pairs to $P_i$? The only constraint on location is that an RNA molecule cannot form a loop of two or fewer nucleotides. Let $A_i$ be the set of all segments that are potential pairs of $P_i$:
\begin{equation}
A_i = \{P_j: 1 \leq j \leq i - 7 \text{ or }i + 7 \leq j \leq N - 3\}
\end{equation}
We can now define the {\em local ambiguity function}, 
\[
a(p) = (a_1(p), \cdots, a_{N - 3}(p))
\]
which is a vector-valued function of the primary structure $p$. The vector has  one component, $a_i(p)$, for each segment $P_i$, which is, simply, the number of feasible segments that are complementary to $P_i$:
\begin{align}
 a_i (p)& =  \# \{ P \in A_i : P \text{ and }P_i \text{ are complementary} \}  
 \label{eqn:LocalAmbiguity} \\
& = 
\#\big\{P_j\in A_i:  (P_{i, k}, P_{j, 5 - k}) \in \{ (A, U), (U, A), (G, C), (C, G), (G,U), (U,G) \},
\nonumber  \\
&  \ \ \ \ \ \ \ \ k=1,\ldots,4 \big\} 
\nonumber 
\end{align}

We want to explore the relationship between ambiguity and secondary structure. 
We can do this conveniently, on a molecule-by-molecule basis, by introducing another vector-valued function, this time depending only on a purported secondary structure.  Specifically, the new function assigns a descriptive label to each location (i.e. each nucleotide), determined by whether the segment at the given location is fully paired, partially paired, or fully unpaired. 

Formally, given a secondary structure $s$, as defined in Eq (2), and a location $i\in\{1, 2,\ldots,N-3\}$, let $f_i(s)$ be the number of nucleotides in $P_i$ that are paired under $s$:
\begin{equation}
f_i(s) = \#\{j\in P_i:(j,k)\in s\text{ or } (k,j)\in s, \text{ for some } 1\leq k \leq N\}
\end{equation}
Evidently, $0\leq f_i(s)\leq 4$. The ``paired nucleotides function'' is then the 
vector-valued function of secondary structure defined as 
$f(s)=(f_1(s),\ldots,f_{N-3}(s))$.
Finally, we use $f$ to distinguish three types of locations (and hence three types of segments): location $i$ will be labeled 
\begin{equation}
	\begin{cases}
		\text{\textit{single} if } f_i(s) = 0 \\
		\text{\textit{double} if } f_i(s) = 4 \\
		\text{\textit{transitional} if } 0 < f_i(s) < 4
	\end{cases} i = 1, 2, \cdots, N - 3
\end{equation}

\subsection*{A First Look at the Data: Shuffling Nucleotides}
Our goals are to explore connections between ambiguities and basic characteristics of RNA families, as well as the changes in these relationships, if any, when using comparative, as opposed to MFE, secondary structures.
For each molecule and each location $i$, the segment at $i$ has been assigned a ``local ambiguity'' $a_i(p)$ that depends only on the primary structure, and a label ({\it single}, {\it double}, or {\it transitional}) that depends only on the secondary structure. Since the local ambiguity, by itself, is strongly dependent on the length of the molecule, and possibly on other intrinsic properties,
we propose two {\em relative} ambiguity indexes: T-S and D-S, each of which depends on both the primary ($p$) and purported secondary ($s$) structures. Formally,
\begin{equation}
	d_\text{T-S}(p, s) = \frac
	{\sum_{j = 0}^{N - 3} a_j (p) 
	c^{\text{tran}}_j (s)}
	{\sum_{j = 0}^{N - 3} 
	c^{\text{tran}}_j (s)} - 
	\frac
	{\sum_{j = 0}^{N - 3} a_j (p) c_j^{\text{single}} (s)}
	{\sum_{j = 0}^{N - 3} c_j^{\text{single}} (s)}
\end{equation}
where we have used
$c_i^{\text{tran}}$ and $c_i^{\text{single}}$ for indicating whether location $i$ is {\it transitional} or {\it single} respectively. In other words, for each $i=1,2,\ldots,N-3$
\begin{align}
	c_i^{\text{tran}}(s) &=
	\begin{cases}
		1, & \text{if location $i$ is \textit{transitional}} \\
		0, & \text{otherwise}
	\end{cases} \\
	c_i^{\text{single}}(s) &=
	\begin{cases}
		1, & \text{if location $i$ is \textit{single}} \\
		0, & \text{otherwise}
	\end{cases}
\end{align}
In short, the T-S ambiguity index is the difference in the averages of the local ambiguities at {\em transitional} sites and {\em single} sites.
Since, as noted earlier, the local ambiguity at every {\em double} location, $i$, 
is likely to be at least one ($a_i\geq 1$), the D-S index involves only those {\em double} and {\em single} locations, $j$, for which $a_j\geq 1$:
\begin{equation}
	d_\text{D-S}(p, s) = \frac
	{\sum_{j = 0}^{N - 3} a_j (p) 
	\hat{c}^{\text{double}}_j (p, s)}
	{\sum_{j = 0}^{N - 3} 
	\hat{c}^{\text{double}}_j (p, s)} - 
	\frac
	{\sum_{j = 0}^{N - 3} a_j (p) \hat{c}_j^{\text{single}} (p,s)}
	{\sum_{j = 0}^{N - 3} \hat{c}_j^{\text{single}} (p,s)}
\end{equation}
Here, $\hat{c}_i^{\text{double}}$ and $\hat{c}^{\text{single}}_i$ indicates those {\em double} and {\em single} locations with at least one pair: for each $i=1,2,\ldots,N-3$,
\begin{align}
	\hat{c}_i^{\text{double}}(p, s) & =
	\begin{cases}
		1, & \text{if location $i$ is \textit{double} and $a_i(p)\geq 1$} \\
		0, & \text{otherwise}
	\end{cases} \\
	\hat{c}_i^{\text{single}}(p, s) & =
	\begin{cases}
		1, & \text{if location $i$ is \textit{single} and $a_i(p)\geq 1$} \\
		0, & \text{otherwise}
	\end{cases}
\end{align}

Thinking kinetically, we might expect to find relatively small values of the T-S and D-S indexes
($d_\text{T-S}$ and $d_\text{D-S}$)
in RNA families which fold and operate as individual entities---what we call here the unbound RNA. One reason for believing this
is that larger numbers of partial matches for a given sequence in or around a stem would likely interfere with the {\em nucleation} of the native stem structure, potentially disrupting folding, and nucleation appears to be a critical and perhaps even rate-limiting step in folding. 
Indeed, the experimental literature  \cite{Porschke1974-hn, Porschke1974-nr, Porschke1977-xz, Mohan2009-gt} has long suggested that stem formation in RNA molecules is a two-step process. When forming a stem, there is usually a slow nucleation step, resulting in a few consecutive base pairs at a nucleation point, followed by a fast zipping step. 
Since the ambiguity indexes are functions of the secondary structure, $s$, 
our expectations are made, implicitly, under the assumption that $s$ is correct. For the time being we will focus only on comparative structures, returning later to the questions about MFE structures raised in the {\em Introduction}. 

How are
we to gauge $d_\text{T-S}$ and $d_\text{D-S}$, and how are we to compare their values across different RNA families? 
Consider the following experiment: for a given RNA molecule we create a ``surrogate'' which has the same nucleotides, and in fact the same counts of {\em all} four-tuple segments as the original molecule, but is otherwise ordered randomly. If ACCU appeared eight times in the original molecule, then it appears eight times in the surrogate, and the same can be said of all sequences of four successive nucleotides---the frequency of each of the $4^4$ possible segments is preserved in the surrogate.  If we also preserve the locations of the {\it transitional}, {\it double}, and {\it single} labels, then we can compute new values for $d_\text{T-S}$ and $d_\text{D-S}$,
say  $\tilde{d}_\text{T-S}$ and $\tilde{d}_\text{D-S}$, from the surrogate. If we produce many surrogate sequences then we will get a sampling of  
surrogate values, $\tilde{d}_\text{T-S}$ and $\tilde{d}_\text{D-S}$, to which we can compare $d_\text{T-S}$ and $d_\text{D-S}$, respectively. We made several experiments of this type---for each of the two indexes, T-S and D-S, within each of the seven RNA families (Group I and Group II Introns, tmRNA, SRP RNA, RNase P, and 16s and 23s rRNA).

To make this precise, consider an RNA molecule with primary structure $p$ and comparative secondary structure $s$. Construct a segment ``histogram function,'' $\mathcal{H}(p)$, which is the 
vector of the number of times that each of the $4^4$ possible segments appears in $p$.\footnote{${\cal H}$ is made a vector by fixing an arbitrary ordering of all possible segments.}
Let $\mathcal{P}(p)$ be the set of all permutations of the ordering of nucleotides in $p$, and let 
$\mathcal{E}(p)\subseteq\mathcal{P}(p)$ be the subset of permutations that preserve the frequencies of four-tuples:
\[
{\cal E}(p) = \{p'\in\mathcal{P}(p): {\cal H}(p')={\cal H}(p)\}
\]
Clever algorithms exist for efficiently drawing independent samples from the uniform distribution on $\mathcal{E}$---see \cite{Kandel1996-kz, Fitch1983-ec, Altschul1985-nq}. Let $p^{(1)},
\ldots,p^{(K)}$ be $K$ such samples, and let $\displaystyle
d_\text{T-S}\big(p^{(1)},s\big),\ldots,d_\text{T-S}\big(p^{(K)},s\big)$ and
$\displaystyle
d_\text{D-S}\big(p^{(1)},s\big),\ldots,d_\text{D-S}\big(p^{(K)},s\big)$ 
be the corresponding T-S and D-S ambiguity indexes. The results are not very sensitive to $K$, nor to the particular sample, provided that $K$ is large enough. We used $K=$10,000. Finally, let 
$\alpha_\text{T-S}(p,s) \in [0,1]$ and
$\alpha_\text{D-S}(p,s) \in [0,1]$
be the left-tail empirical probabilities, under the distributions defined by the ensembles
\begin{align}
&  d_\text{T-S}(p,s),d_\text{T-S}\big(p^{(1)},s\big),\ldots,d_\text{T-S}\big(p^{(K)},s\big) 
\label{eqn:T-Sensemble}\\
\text{and \hglue .8cm} 
& d_\text{D-S}(p,s),d_\text{D-S}\big(p^{(1)},s\big),\ldots,d_\text{D-S}\big(p^{(K)},s\big) 
\label{eqn:D-Sensemble}
\end{align}
of choosing an ambiguity index less than or equal to $d_\text{T-S}(p,s)$ and 
$d_\text{T-S}(p,s)$, respectively:
\begin{align}
\alpha_\text{T-S}(p,s)  & = \frac
{1 + \#\{k\in\{1,\ldots,K\}: d_\text{T-S}\big(p^{(k)},s\big) \leq d_\text{T-S}(p,s)\}}{1+K} \label{eqn:alpha_T-S} \\
\alpha_\text{D-S}(p,s)  & = \frac
{1 + \#\{k\in\{1,\ldots,K\}: d_\text{D-S}\big(p^{(k)},s\big)\leq d_\text{D-S}(p,s)\}}{1+K} \label{eqn:alpha_D-S}
\end{align}
In essence, each $\alpha$ score is a self-calibrated ambiguity index.

It is tempting to interpret $\alpha_\text{T-S}(p,s)$ as a p-value from a conditional hypothesis test: Given $s$ and $\mathcal{H}$, test the null hypothesis that $d_\text{T-S}(p,s)$ is statistically indistinguishable from  
$d_\text{T-S}(p^\prime,s)$, where $p^\prime$ is a random sample from $\mathcal{E}$. If the alternative hypothesis were that $d_\text{T-S}(p,s)$ is too small to be consistent with the null,  then the null is rejected in favor of the alternative with probability $\alpha_\text{T-S}(p,s)$. The problem with this interpretation, and the analogous one for $\alpha_\text{D-S}(p,s)$, is that this null hypothesis violates the observation that given $\mathcal{H}$ there is information in $s$ about $p$, whereas  $p^{(1)},\ldots,p^{(K)}$ are independent of $s$ given $\mathcal{H}$. 
In other words, $d_\text{T-S}(p,s)$ and $d_\text{T-S}(p^\prime,s)$
have different conditional distributions given $s$ and $\mathcal{H}$, in direct contradiction to the null hypothesis.
A larger problem is that there is no reason to believe the alternative; we are more interested in {\em relative} than absolute ambiguity indexes. Thinking of  
$\alpha_\text{T-S}(p,s)$ and $\alpha_\text{D-S}(p,s)$ as calibrated intra-molecular indexes, we want to know how they vary across RNA families, and whether these variations depend on the differences between comparative and MFE structures.

Nevertheless, $\alpha_\text{T-S}(p,s)$ and $\alpha_\text{D-S}(p,s)$ are useful statistics for exploratory analysis.  Table \ref{table:explore_comp} provides summary data about the $\alpha$ scores for each of the seven RNA families. 
For each molecule in each family we use the primary structure and the comparative secondary structure, and $K=$10,000 samples from $\mathcal{E}$, to compute
individual T-S and D-S $\alpha$ scores (Eqs \ref{eqn:alpha_T-S} and \ref{eqn:alpha_D-S}). Keeping in mind that a smaller value of $\alpha$ represents a smaller {\em calibrated} value of the corresponding ambiguity index, $d(p,s)$, there is evidently a disparity between ambiguity indexes of RNA molecules that form ribonucleoproteins and those of RNA that are already active as individual molecules. As a group, the unbound molecules have systematically lower ambiguity indexes. As already noted, this observation is consistent with, and in fact anticipated by, the kinetic point of view. Shortly, we will support this observation with ROC curves and rigorous hypothesis tests.

\vglue .1cm
\begin{table}[h!]
\begin{center}
\begin{tabular}{ l || r | r | r | r}
\hglue 5mm 
 & {\bf number} & {\bf median}  &
{\bf median } & {\bf median }   \\
 {\bf family} & {\bf molecules} & {\bf length} &
$\bm \alpha_\text{\bf T-S}$ &  $\bm \alpha_\text{\bf D-S}$ 
 \\ \hline \hline
\input{exploratory_comparative.tex}
\end{tabular}
\vglue .5cm
\caption{\footnotesize {\bf Comparative Secondary Structures: calibrated ambiguity indexes, by RNA family.} The number of molecules, the median length (number of nucleotides), and the median $\alpha$ scores for T-S and D-S ambiguity indexes  (Eqs \ref{eqn:alpha_T-S} and \ref{eqn:alpha_D-S}) for each of the seven RNA families studied. RNA molecules from the first two families are active as single molecules (unbound); the remaining five are bound in  ribonucleoproteins. Unbound RNA molecules have lower ambiguity indexes.}
\label{table:explore_comp}
\end{center}
\end{table}

Does the MFE structure similarly separate single-entity RNA molecules from those that form ribonucleoproteins? A convenient way to explore this question is to recalculate and recalibrate the ambiguity indexes of each molecule in each of the seven families, but using the MFE in place of the comparative secondary structures. The results are summarized in Table \ref{table:explore_MFE}.
By comparison to the results shown from Table \ref{table:explore_comp}, 
the separation of unbound from bound molecules nearly disappears under the MFE secondary structures.
Possibly, the comparative structures, as opposed to the MFE structures, better anticipate the need to avoid energy traps in the folding landscape. Here too we will soon revisit the data using ROC curves and proper hypothesis tests.

\vglue .1cm
\begin{table}[h!]
\begin{center}
\begin{tabular}{ l || r | r | r | r}
\hglue 5mm 
 & {\bf number} & {\bf median}  &
{\bf median } & {\bf median }   \\
 {\bf family} & {\bf molecules} & {\bf length} &
$\bm{\alpha_\text{\bf T-S}}$ &  $\bm \alpha_\text{\bf D-S}$ 
 \\ \hline \hline
\input{exploratory_mfe.tex}
\end{tabular}
\vglue .5cm
\caption{\footnotesize {\bf MFE Secondary Structures: calibrated ambiguity indexes, by RNA family.} Identical to Table \ref{table:explore_comp}, except that the ambiguity indexes and their calibrations are calculated using the MFE secondary structures rather than comparative analyses. There is little evidence in the MFE secondary structures for lower ambiguity indexes among unbound RNA molecules.}
\label{table:explore_MFE}
\end{center}
\end{table}

\subsection*{Formal Statistical Analyses}
The T-S and D-S ambiguity indexes ($d_\text{T-S}(p,s)$ and $d_\text{D-S}(p,s)$)  are intra-molecular measures of the extent to which segments that lie in and around sub-sequences that are double-stranded have more Watson-Crick and wobble pairings than
segments within single-stranded regions. As such, they depend on both $p$ and any purported secondary structure, $s$. Based on calibrated versions of these indexes ($\alpha_\text{T-S}(p,s)$ and $\alpha_\text{D-S}(p,s)$) and employing the comparative secondary structure for $s$ we found support for the idea that non-coding RNA molecules which are active as individual entities are more likely to have small ambiguity indexes than RNA molecules destined to operate as part of ribonculeoproteins. Furthermore, the difference appears to be sensitive to the approach used for identifying secondary structure---there is little, if any, evidence in the MFE secondary structures for lower ambiguities among unbound molecules.

These qualitative observations can be used to formulate precise statistical hypothesis tests.  Many tests come to mind, but perhaps the simplest and most transparent are based on nothing more than the molecule-by-molecule signs of the ambiguity indexes. Whereas ignoring the actual values of the indexes is inefficient in terms of information, and probably also in the strict statistical sense, tests based on signs require very few assumptions and are, therefore, more robust to model misspecification. All of the p-values that we will report are based on the hypergeometric distribution, which arises as follows.

We are given a population of $M$ molecules, $m=1,\ldots,M$, each with a binary outcome measure $B_m\in\{-1,+1\}$.
There are two subpopulations of interest: the first $M_1$ molecules make up population 1 and the next $M_2$ molecules make up population 2; $M_1+M_2=M$. We observe $n_1$ plus values in population 1 and $n_2$ in population 2 
\begin{align}
n_1 & = \#\big\{m\in\{1,2,\ldots,M_1\}:B_m=+1\big\} \\
n_2 & = \#\big\{m\in\{M_1+1,M_1+2,\ldots,M\}:B_m=+1\big\}
\end{align}
We suspect that population 1 has less than its share of plus ones, meaning that the $n_1+n_2$ population of plus ones was not randomly distributed among the $M$ molecules. To be precise, let $N$ be the number of plus ones that appear from a draw, without replacement, of $M_1$ samples from $B_1,\ldots,B_M$. Under the null hypothesis, $H_o$, $n_1$ is a sample from the hypergeometric distribution on $N$:
\begin{equation}
\label{eqn:null}
\mathbb{P}\{N=n\} = \frac{\binom{M_1}{n}\binom{M_2}{n_1+n_2-n}}
{\binom{M}{n_1+n_2}}\quad \max\{0,n_1+n_2-M_2\}\leq n 
\leq \min\{n_1+n_2,M_1\}
\end{equation}
The alternative hypothesis, $H_a$, is that $n_1$ is too small to be consistent with $H_o$, leading to a left-tail test with p-value $\mathbb{P}\{N\leq n_1\}$ (which can be computed directly or using a statistical package, e.g. {\em hypergeom.cdf} in {\em scipy.stats}).

It is by now well recognized that p-values should never be the end of the story. One reason is that {\em any} departure from the null hypothesis in the direction of the alternative, no matter how small, is doomed to be statistically significant, with arbitrarily small p-value, once the sample size is sufficiently large. In addition to reporting p-values, we will also display estimated ROC curves, summarizing performance of a related classification problem.  There are eight such problems: Under each of the comparative and MFE secondary structures, how well can we use $d_\text{T-S}(p,s)$ or $d_\text{D-S}(p,s)$ to classify a given molecule as bound or unbound? And, given 
$d_\text{T-S}(p,s)$ or $d_\text{D-S}(p,s)$ for a molecule that is known to be bound or unbound, how well can we classify the secondary structure, $s$, as coming from a comparative analysis versus an MFE analysis?

\subsubsection*{Single-entity RNA Molecules versus Protein-RNA Complexes}
Consider an RNA molecule, $m$, selected from one of the seven families in our data set, with primary structure $p$ and secondary structure $s$, computed by comparative analysis.
Given only the T-S ambiguity index of $m$ (i.e. given only $d_\text{T-S}(p,s)$), 
how accurately could we classify $m$ as being unbound (i.e. from the Group I or Group II Introns) as opposed to bound (i.e. from one of the five families tmRNA, SRP RNA, RNase P, 16s rRNA or 23s rRNA)? 
The foregoing exploratory analysis suggests constructing a classifier that declares a molecule to be `unbound' when $d_\text{T-S}(p,s)$ is small, e.g. $d_\text{T-S}(p,s)<t$, where the threshold $t$ governs the familiar trade off between rates of ``true positives'' (an unbound $m$ is declared `unbound') and ``false positives'' (a bound $m$ is declared `unbound').
Small values of $t$ favor low rates of false positives at the price of low rates of true positives, whereas large values of $t$ favor high rates of true-positives at the price of high rates of false positives. Since for each molecule $m$ we have both the correct classification (unbound or bound) and the statistic $d$, we can estimate the ROC performance of our threshold classifier by plotting the empirical values of the pair
\[
  \text{(\# false positives,\ \# true positives)}
\]
for each value of $t$. The ROC curve for the two-category (unbound versus bound) classifier based on thresholding $d_\text{T-S}(p,s)<t$ is shown in the upper-left panel of Figure \ref{fig:UnboundVSBound}. 
Also shown is the estimated area under the curve (AUC=0.81), which has a convenient and intuitive interpretation, as it is equal to the probability that for two randomly selected molecules, $m$ from the unbound population and $m^\prime$ from the bound population, the T-S ambiguity index of $m$ will be smaller than the T-S ambiguity index of $m^\prime$. 

\input{bound_unbound.tex}

As mentioned earlier, we can also associate a traditional p-value to the problem of separating unbound from bound molecules, based on the T-S ambiguity indexes. We consider only the signs (positive or negative) of these indexes, and then test whether there are fewer than expected positive indexes among the unbound, as opposed to the bound, population. This amounts to computing $\mathbb{P}\{N\leq n_1\}$ from the hypergeometric distribution---Eq (\ref{eqn:null}). The relevant statistics can be found in Table \ref{table:NumberPositive}, 
under the column labels {\bf \#mol's} and $\bm{\#d_\text{\bf T-S}>0}$. Specifically, 
$M_1=116+34=150$ (number of unbound molecules),
$M_2=404+346+407+279+59=1495$ (number of bound molecules), $n_1=50+8=58$ (number of positive T-S indexes among unbound molecules) and $n_2=368+269+379+210+53=1279$.
The resulting p-value, $1.2\cdot 10^{-34}$, is essentially zero, meaning that the positive T-S indexes are not distributed proportional to the sizes of the unbound and bound populations, which is by now obvious in any case. To repeat our caution, small p-values conflate sample size with effect size, and for that reason we have chosen additional ways, using permutations as well as classifications, to look at the data.

\vglue .1cm
\begin{table}[h!]
\begin{center}
\begin{tabular}{ l || r | r | r | r | r}
\hglue 5mm 
{\bf family} & {\bf \#mol's} & {\bf\#}$\bm{d_\text{\bf T-S}\!>\!0}$ &
{\bf\#}$\bm{d_\text{\bf D-S}\!>\!0}$ & {\bf\#}$\bm{d_\text{\bf \~T-\~S}\!>\!0}$ & {\bf\#}$\bm{d_\text{\bf \~D-\~S}\!>\!0}$ \\ \hline \hline
\input{formal_analysis.tex}
\end{tabular}
\vglue .5cm
\caption{\footnotesize {\bf Numbers of Positive Ambiguity Indexes, by family.} 
{\bf \#mol's}: number of molecules; {\bf\#}$\bm{d_\text{\bf T-S}>0}$ and 
 {\bf\#}$\bm{d_\text{\bf D-S}>0}$: numbers of positive T-S and D-S ambiguity indexes, secondary structures computed by {\em comparative analysis}; 
 {\bf\#}$\bm{d_\text{\bf \~T-\~S}>0}$ and {\bf\#}$\bm{d_\text{\bf \~D-\~S}>0}$: numbers of positive T-S and D-S ambiguity indexes, secondary structures computed by {\em minimum free energy}.
} 
\label{table:NumberPositive}
\end{center}
\end{table}

The comparative secondary structure of an RNA molecule, when combined with its primary structure, can be used to construct a measure---the T-S ambiguity index---which distinguishes unbound from bound molecules with good accuracy. Can the same can be said for the D-S index?
Yes, albeit with lower accuracy. To demonstrate, we followed the identical procedure, except that we assigned the index $d_\text{D-S}(p,s)$ rather than $d_\text{T-S}(p,s)$ to each molecule.  The ROC curve (with area 0.65) is shown in the lower-left panel of Figure \ref{fig:UnboundVSBound}. The hypergeometric test, based on the signs of the D-S indexes
(positive counts, for each RNA family, can be found in Table \ref{table:NumberPositive}) has p-value $7.3\cdot 10^{-8}$. Finally, the right-hand panels in Figure \ref{fig:UnboundVSBound} mirror the left-hand panels, except that all secondary structures were computed by (approximately) minimizing free energy rather than comparative analysis. The classification results are substantially less convincing and the p-values substantially higher.  

\subsubsection*{Comparative Analysis versus Minimum Free Energy}
As we have just seen, ambiguity indexes based on MFE secondary structures, as opposed to  comparative secondary structures, do not make the same stark 
distinction between single and bound RNA molecules. 
To explore this a little further, we can turn the analyses of the previous paragraphs around
and ask to what extent knowledge of the group of a molecule (unbound or bound) and its ambiguity index (e.g. the T-S ambiguity index) is sufficient to predict the source of the secondary structure---comparative or free energy? 

Interestingly, there is a sharp difference in predicting the source of secondary structure in unbound molecules as opposed to bound molecules. Consider the top two ROC curves in Figure
\ref{fig:CompVSMFE}. In each of the two experiments a classifier was constructed by thresholding the T-S ambiguity index, declaring the secondary structure to be 
``comparative" when $d_\text{T-S}(p,s)<t$ and ``MFE" otherwise, since, as we have seen, smaller values of the ambiguity indexes are generally associated with the comparative secondary structure. The ROC curves are then swept out by varying $t$. The difference between the two panels is in the population used for the classification experiments---unbound molecules in the upper-left and bound molecules in the upper-right. In unbound molecules, small values of the T-S ambiguity index are a good indication that a secondary structure was derived from comparative rather than free-energy analysis, but not in bound molecules. The corresponding hypothesis tests seek evidence against the null hypotheses that in a given group (unbound or bound) the set of positive T-S ambiguity indexes ($d_\text{T-S}(p,s)>0$) are equally distributed between the comparative and free-energy derived indexes, and in favor of the alternatives that the T-S ambiguity indexes are less typically positive for the comparative secondary structures. The necessary data can be found in Table \ref{table:NumberPositive}. The results are consistent with the classification experiments: the hypergeometric p-value is 
is $5.4\cdot 10^{-14}$ for the unbound population and $0.07$ for the bound population.

The same experiments, with the same conclusions, were also performed using the D-S ambiguity index, as shown in the bottom two panels of Figure \ref{fig:CompVSMFE}, for which the corresponding hypergeometric p-values are $3.8\cdot 10^{-7}$ (unbound population) and
$0.01$ (bound population). 


\input{comparative_mfe.tex}

\newpage

\bibliography{reference.bib}

\end{document}
